<!--
graphs.html

This Django template renders the graph analytics page for the voter_analytics application.

Features:
- A navigation bar to switch between the home page, voter list, and graphs.
- A filter form that allows users to filter voters by party affiliation, birth year range, voter score,
  and participation in recent elections.
- Three interactive Plotly charts are rendered based on the filtered voter set:
    1. Year of Birth Histogram
    2. Party Affiliation Pie Chart
    3. Election Participation Bar Chart

Template Context Variables:
- voters: The filtered queryset of Voter objects.
- years: List of years (1900–2024) for dropdown filters.
- yob_chart: Safe HTML representation of the birth year histogram.
- party_chart: Safe HTML representation of the pie chart.
- participation_chart: Safe HTML representation of the bar chart.
-->

{% load static %}
<!DOCTYPE html>
<html>
<head>
  <title>Graphs</title>
  <link rel="stylesheet" href="{% static 'voter_analytics/css/styles.css' %}">
  <link rel="icon" href="data:,">
</head>
<body>
<div class="navbar">
  <a href="{% url 'home' %}" class="{% if request.path == '/' %}active{% endif %}">🏠 Home</a>
  <a href="{% url 'voters' %}">📋 Voter List</a>
  <a href="{% url 'graphs' %}" class="active">📊 Graphs</a>
</div>

<div class="filter-summary-form">
  <div class="summary-box">
    Showing <strong>{{ voters.count }}</strong> voters matched the filter criteria.
  </div>
  <form method="get">
    <div class="filter-row">
      <label for="party">Party Affiliation:</label>
      <select name="party" id="party">
        <option value="">Any</option>
        <option value="D">D</option>
        <option value="R">R</option>
        <option value="U">U</option>
      </select>
    </div>
    <div class="filter-row">
      <label for="score">Voter Score:</label>
      <select name="score" id="score">
        <option value="">Any</option>
        {% for i in "012345"|make_list %}
          <option value="{{ i }}">{{ i }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="filter-row">
      <label for="min_year">Min Year of Birth:</label>
      <select name="min_year" id="min_year">
        <option value="">Any</option>
        {% for year in years %}
          <option value="{{ year }}">{{ year }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="filter-row">
      <label for="max_year">Max Year of Birth:</label>
      <select name="max_year" id="max_year">
        <option value="">Any</option>
        {% for year in years %}
          <option value="{{ year }}">{{ year }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="filter-row">
      <label>Election Participation:</label>
      <div class="checkbox-group">
        <label><input type="checkbox" name="v20state"> v20state</label>
        <label><input type="checkbox" name="v21town"> v21town</label>
        <label><input type="checkbox" name="v21primary"> v21primary</label>
        <label><input type="checkbox" name="v22general"> v22general</label>
        <label><input type="checkbox" name="v23town"> v23town</label>
      </div>
    </div>
    <div class="filter-row filter-submit">
      <button type="submit">Search</button>
    </div>
  </form>
</div>

<h1>Graphs</h1>
<div class="graph-section">
  <div class="chart">
    {{ yob_chart|safe }}
  </div>
  <div class="chart">
    {{ party_chart|safe }}
  </div>
  <div class="chart">
    {{ participation_chart|safe }}
  </div>
</div>

</body>
</html>
