<!--
voter_list.html

This Django template displays a paginated, filterable table of registered voters.

Features:
- Navigation bar with links to Home, Voter List, and Graphs pages.
- A filter form allowing users to narrow down the voter list by:
    - Party affiliation
    - Voter score
    - Year of birth range
    - Participation in past elections (2020–2023)
- A styled table showing voter details including name, address, date of birth, party, and score.
- A result summary section showing the number of matching results and a "Next page" shortcut.
- Pagination links at the bottom to navigate through the full dataset.

Template Context Variables:
- page_obj: A Django pagination object containing the current page of voter results.
- years: A list of birth years (1900–2024) used in dropdown filters.
-->


{% load static %}
<!DOCTYPE html>
<html>
<head>
  <title>Voter List</title>
  <link rel="stylesheet" href="{% static 'voter_analytics/css/styles.css' %}">
  <link rel="icon" href="data:,">
</head>
<body>

<div class="navbar">
  <a href="{% url 'home' %}" class="{% if request.path == '/' %}active{% endif %}">🏠 Home</a>
  <a href="{% url 'voters' %}" class="active">📋 Voter List</a>
  <a href="{% url 'graphs' %}">📊 Graphs</a>
</div>

<div class="filter-summary-form">
  <div class="summary-box">
    Showing <strong>{{ page_obj.paginator.count }}</strong> voters matched the filter criteria.
  </div>

  <form method="get">
    <div class="filter-row">
      <label for="party">Party Affiliation:</label>
      <select name="party" id="party">
        <option value="">Any</option>
        <option value="D">D</option>
        <option value="R">R</option>
        <option value="U">U</option>
      </select>
    </div>

    <div class="filter-row">
      <label for="score">Voter Score:</label>
      <select name="score" id="score">
        <option value="">Any</option>
        {% for i in "012345"|make_list %}
          <option value="{{ i }}">{{ i }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="filter-row">
      <label for="min_year">Min Year of Birth:</label>
      <select name="min_year" id="min_year">
        <option value="">Any</option>
        {% for year in years %}
          <option value="{{ year }}">{{ year }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="filter-row">
      <label for="max_year">Max Year of Birth:</label>
      <select name="max_year" id="max_year">
        <option value="">Any</option>
        {% for year in years %}
          <option value="{{ year }}">{{ year }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="filter-row">
      <label>Election Participation:</label>
      <div class="checkbox-group">
        <label><input type="checkbox" name="v20state"> v20state</label>
        <label><input type="checkbox" name="v21town"> v21town</label>
        <label><input type="checkbox" name="v21primary"> v21primary</label>
        <label><input type="checkbox" name="v22general"> v22general</label>
        <label><input type="checkbox" name="v23town"> v23town</label>
      </div>
    </div>

    <div class="filter-row filter-submit">
      <button type="submit">Search</button>
    </div>
  </form>
</div>

<h1>Voter List</h1>

<div class="voter-list-container">
  <!-- 将 "results found" 板块融入到 voter 表格 section 中，位于表格上方 -->
  <div class="results-found-box">
    <span>{{ page_obj.paginator.count }} results found.</span>
    {% if page_obj.has_next %}
      <a class="results-next-btn" href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.next_page_number }}">
         Next page
      </a>
    {% endif %}
  </div>
  <table class="voter-list-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Address</th>
        <th>Date of Birth</th>
        <th>Party</th>
        <th>Voter Score</th>
      </tr>
    </thead>
    <tbody>
      {% for voter in page_obj %}
      <tr>
        <td>
          <a href="{% url 'voter' voter.pk %}">
            {{ voter.first_name }} {{ voter.last_name }}
          </a>
        </td>
        <td>
          {{ voter.street_number }} {{ voter.street_name }}{% if voter.apartment_number %}, Apt {{ voter.apartment_number }}{% endif %}
        </td>
        <td>{{ voter.date_of_birth }}</td>
        <td>{{ voter.party_affiliation }}</td>
        <td>{{ voter.voter_score }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="pagination">
  {% if page_obj.has_previous %}
    <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.previous_page_number }}">Previous</a>
  {% endif %}

  Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}

  {% if page_obj.has_next %}
    <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.next_page_number }}">Next</a>
  {% endif %}
</div>

</body>
</html>
